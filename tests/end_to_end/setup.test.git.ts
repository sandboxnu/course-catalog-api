import { gql } from "apollo-server";
import prisma from "../../services/prisma";
import server from "../../graphql/index";
import { DocumentNode } from "graphql";
import { GraphQLResponse } from "apollo-server-core";

const NUM_TERMIDS = 3;
const NUMS_COURSES = {
  "202240": 646,
  "202250": 519,
  "202260": 493,
};
const NUMS_SECTIONS = {
  "202240": 840,
  "202250": 1634,
  "202260": 515,
};
const NUM_SECTIONS = Object.values(NUMS_SECTIONS).reduce((a, b) => a + b, 0);
const NUM_COURSES = Object.values(NUMS_COURSES).reduce((a, b) => a + b, 0);

async function query(q: DocumentNode): Promise<GraphQLResponse> {
  return await server.executeOperation({ query: q });
}

describe("TermID setup", () => {
  test("term IDs are in the database", async () => {
    expect(await prisma.termInfo.count()).toBe(NUM_TERMIDS);
  });

  test("termIDs are accessible through GraphQL", async () => {
    const res = await query(gql`
      query {
        termInfos(subCollege: "NEU") {
          text
          termId
          subCollege
        }
      }
    `);
    expect(res.data?.termInfos.length).toBe(NUM_TERMIDS);
  });

  test("The termIDs in the database match those in GraphQL", async () => {
    const res = await query(gql`
      query {
        termInfos(subCollege: "NEU") {
          text
          termId
          subCollege
        }
      }
    `);
    const gqlTermInfos = res.data?.termInfos.map((t) => t.termId).sort();

    const dbTermInfos = (
      await prisma.termInfo.findMany({
        select: {
          termId: true,
          subCollege: true,
          text: true,
        },
      })
    )
      .map((t) => t.termId)
      .sort();

    expect(dbTermInfos).toEqual(gqlTermInfos);
  });
});

describe("Course and section setup", () => {
  test("courses/sections are in the database", async () => {
    for (const [termId, expected] of Object.entries(NUMS_COURSES)) {
      const actual = await prisma.course.count({
        where: {
          termId: termId,
        },
      });
      expect(actual).toBe(expected);
    }

    expect(await prisma.course.count()).toBe(NUM_COURSES);

    for (const [termId, expected] of Object.entries(NUMS_SECTIONS)) {
      const actual = await prisma.section.count({
        where: {
          course: {
            termId: termId,
          },
        },
      });

      // Temporary logging
      const crns = (
        await prisma.section.findMany({
          orderBy: { crn: "desc" },
        })
      ).map((x) => x.crn);

      // TODO - save all old CRNs. Compare here - what's the diff???
      const old_crns = [
        "40030",
        "40029",
        "40148",
        "40149",
        "40150",
        "40151",
        "40028",
        "40118",
        "40286",
        "40210",
        "41676",
        "40171",
        "40092",
        "40101",
        "41331",
        "40087",
        "41441",
        "41119",
        "41442",
        "40091",
        "41443",
        "40090",
        "41444",
        "40114",
        "41445",
        "40443",
        "41412",
        "41482",
        "41483",
        "41439",
        "40987",
        "41252",
        "40420",
        "40104",
        "41129",
        "40110",
        "40119",
        "41130",
        "40406",
        "41432",
        "40998",
        "41433",
        "41434",
        "41435",
        "41718",
        "41436",
        "40187",
        "40153",
        "40377",
        "41150",
        "41243",
        "40995",
        "41255",
        "41430",
        "41431",
        "40996",
        "41127",
        "40997",
        "40488",
        "41128",
        "40489",
        "41437",
        "41719",
        "40690",
        "40993",
        "40691",
        "40994",
        "41429",
        "40382",
        "40988",
        "40301",
        "40302",
        "40390",
        "40892",
        "41204",
        "41144",
        "41344",
        "41349",
        "40740",
        "41136",
        "40799",
        "41165",
        "41325",
        "40863",
        "40868",
        "41385",
        "41386",
        "41387",
        "41388",
        "41389",
        "41390",
        "41391",
        "41392",
        "41393",
        "41394",
        "41395",
        "41396",
        "41397",
        "41398",
        "41399",
        "41400",
        "41401",
        "41402",
        "41403",
        "41404",
        "41405",
        "41406",
        "41407",
        "41408",
        "40845",
        "41266",
        "40755",
        "40448",
        "40524",
        "40477",
        "40478",
        "40480",
        "40659",
        "41583",
        "41584",
        "41074",
        "41075",
        "41148",
        "40482",
        "41457",
        "40099",
        "40100",
        "40172",
        "40178",
        "40268",
        "40288",
        "41458",
        "41459",
        "41460",
        "41461",
        "41462",
        "41463",
        "40299",
        "40300",
        "40739",
        "41578",
        "41546",
        "40580",
        "41464",
        "41465",
        "40662",
        "41649",
        "40483",
        "40407",
        "40408",
        "40409",
        "40410",
        "40498",
        "40499",
        "40599",
        "40179",
        "40583",
        "40466",
        "40663",
        "41579",
        "41582",
        "40279",
        "41573",
        "40756",
        "41230",
        "40280",
        "41715",
        "41071",
        "41072",
        "41446",
        "41447",
        "41297",
        "40479",
        "40464",
        "40731",
        "40855",
        "40648",
        "40856",
        "40862",
        "40646",
        "40803",
        "40847",
        "40852",
        "40261",
        "40262",
        "41145",
        "41146",
        "41147",
        "40569",
        "40570",
        "40716",
        "40725",
        "41114",
        "41120",
        "41467",
        "41468",
        "41469",
        "40650",
        "40651",
        "40652",
        "40653",
        "40033",
        "40032",
        "40654",
        "40655",
        "41424",
        "40237",
        "41301",
        "41302",
        "40044",
        "40202",
        "40203",
        "41347",
        "41151",
        "41272",
        "40804",
        "40838",
        "40876",
        "40808",
        "41270",
        "40864",
        "40235",
        "41709",
        "40031",
        "40197",
        "40971",
        "40461",
        "40972",
        "40236",
        "40462",
        "40669",
        "40394",
        "40742",
        "40973",
        "40432",
        "40670",
        "40227",
        "40281",
        "40198",
        "40102",
        "41551",
        "40534",
        "40587",
        "40974",
        "40152",
        "40413",
        "40282",
        "40542",
        "40543",
        "40459",
        "40216",
        "40293",
        "40107",
        "40108",
        "40245",
        "40544",
        "41552",
        "41553",
        "41554",
        "41555",
        "41556",
        "40545",
        "40121",
        "40497",
        "40702",
        "41137",
        "41557",
        "41558",
        "41559",
        "41560",
        "41561",
        "41562",
        "41563",
        "41564",
        "41565",
        "41566",
        "41567",
        "40967",
        "40675",
        "40968",
        "41568",
        "41569",
        "41574",
        "41575",
        "40969",
        "41576",
        "41653",
        "41654",
        "41655",
        "40870",
        "40601",
        "41076",
        "41078",
        "40093",
        "41577",
        "40094",
        "40962",
        "40963",
        "41379",
        "41380",
        "40574",
        "40949",
        "41381",
        "41232",
        "40776",
        "41361",
        "41720",
        "41570",
        "40189",
        "40296",
        "41231",
        "41090",
        "41091",
        "40966",
        "40217",
        "40765",
        "40766",
        "40970",
        "40218",
        "40231",
        "40579",
        "40396",
        "40893",
        "41413",
        "40242",
        "40767",
        "40219",
        "40768",
        "41414",
        "40894",
        "40458",
        "41415",
        "40699",
        "41416",
        "40415",
        "41034",
        "40978",
        "41084",
        "41159",
        "41160",
        "40979",
        "40757",
        "40548",
        "40561",
        "41383",
        "40042",
        "40043",
        "40257",
        "40695",
        "40696",
        "41083",
        "41122",
        "41384",
        "41233",
        "40788",
        "40793",
        "40794",
        "41258",
        "41312",
        "41275",
        "40851",
        "40849",
        "40872",
        "41288",
        "41317",
        "41328",
        "41343",
        "40643",
        "40860",
        "40867",
        "41163",
        "40748",
        "40825",
        "40850",
        "41164",
        "41289",
        "41374",
        "40861",
        "40741",
        "40709",
        "41085",
        "41259",
        "41246",
        "41364",
        "41369",
        "41375",
        "41211",
        "41212",
        "41237",
        "41238",
        "41239",
        "41240",
        "41241",
        "41242",
        "41215",
        "41250",
        "41251",
        "40405",
        "40417",
        "40096",
        "41450",
        "40412",
        "41451",
        "41452",
        "40798",
        "41684",
        "41453",
        "40204",
        "40223",
        "41111",
        "40205",
        "41112",
        "41202",
        "40539",
        "40379",
        "40425",
        "40431",
        "40473",
        "40676",
        "40581",
        "40472",
        "40206",
        "40207",
        "40290",
        "40381",
        "40426",
        "40430",
        "40447",
        "40474",
        "40677",
        "40582",
        "40208",
        "40209",
        "41454",
        "40248",
        "40291",
        "40378",
        "40429",
        "40471",
        "40720",
        "40750",
        "40540",
        "40541",
        "41153",
        "40249",
        "40250",
        "40891",
        "40380",
        "40251",
        "40576",
        "40252",
        "40253",
        "40395",
        "40707",
        "40562",
        "41245",
        "40243",
        "40097",
        "40244",
        "40027",
        "40026",
        "40017",
        "40275",
        "40700",
        "40790",
        "40274",
        "41035",
        "40254",
        "40211",
        "41591",
        "41589",
        "41033",
        "41036",
        "41590",
        "40298",
        "41592",
        "40297",
        "41045",
        "41100",
        "41448",
        "41696",
        "41697",
        "41094",
        "41097",
        "40693",
        "40694",
        "41438",
        "40161",
        "40041",
        "40388",
        "40536",
        "40476",
        "41409",
        "41410",
        "40387",
        "41411",
        "40706",
        "40859",
        "41484",
        "41485",
        "40259",
        "40712",
        "41486",
        "40956",
        "40649",
        "41717",
        "41549",
        "40573",
        "41550",
        "41428",
        "41537",
        "41572",
        "41678",
        "40713",
        "41449",
        "40246",
        "41092",
        "40687",
        "40468",
        "41096",
        "41264",
        "41086",
        "41588",
        "40404",
        "41479",
        "41362",
        "40743",
        "40858",
        "41314",
        "40844",
        "40953",
        "40686",
        "40120",
        "41316",
        "40045",
        "40276",
        "40089",
        "40086",
        "40158",
        "40220",
        "40221",
        "41548",
        "41456",
        "41580",
        "41581",
        "40427",
        "41538",
        "41593",
        "40022",
        "40021",
        "40256",
        "41105",
        "40490",
        "41095",
        "41477",
        "41547",
        "40212",
        "40255",
        "40088",
        "40532",
        "40705",
        "40020",
        "40019",
        "40018",
        "40424",
        "40446",
        "40519",
        "40728",
        "40730",
        "41585",
        "40486",
        "41586",
        "41587",
        "40689",
        "40215",
        "41032",
        "40105",
        "40111",
        "40012",
        "40123",
        "40003",
        "40805",
        "40038",
        "40046",
        "40113",
        "40002",
        "40129",
        "41077",
        "41079",
        "41080",
        "40284",
        "40518",
        "41704",
        "40285",
        "40383",
        "41069",
        "41705",
        "40037",
        "40710",
        "41706",
        "40201",
        "41070",
        "41073",
        "40389",
        "40529",
        "40484",
        "40450",
        "40634",
        "41081",
        "40792",
        "40640",
        "40039",
        "40632",
        "40247",
        "40744",
        "40411",
        "41103",
        "41594",
        "41595",
        "40040",
        "40106",
        "41596",
        "40001",
        "40112",
        "40550",
        "41480",
        "40159",
        "40566",
        "40224",
        "40575",
        "41037",
        "41188",
        "41307",
        "40865",
        "40871",
        "40857",
        "41366",
        "40733",
        "41293",
        "40848",
        "40991",
        "40393",
        "40671",
        "40535",
        "41422",
        "40537",
        "40181",
        "40454",
        "40014",
        "40013",
        "40214",
        "40538",
        "41104",
        "40109",
        "40036",
        "41088",
        "41089",
        "41311",
        "40821",
        "40520",
        "40146",
        "40147",
        "40551",
        "40552",
        "41703",
        "41700",
        "40682",
        "40084",
        "40190",
        "40232",
        "40976",
        "40977",
        "40180",
        "41481",
        "41182",
        "40025",
        "40024",
        "40016",
        "40213",
        "41371",
        "41340",
        "40130",
        "40391",
        "40455",
        "41142",
        "40199",
        "40896",
        "40527",
        "41382",
        "40456",
        "41049",
        "41050",
        "41051",
        "41052",
        "41053",
        "41054",
        "41055",
        "40399",
        "40400",
        "40401",
        "40795",
        "40103",
        "40475",
        "41470",
        "41471",
        "41472",
        "41473",
        "41474",
        "40182",
        "40183",
        "40184",
        "40188",
        "40234",
        "40277",
        "40724",
        "40185",
        "40009",
        "40397",
        "40008",
        "40007",
        "40006",
        "40162",
        "40163",
        "40191",
        "40226",
        "40233",
        "40269",
        "40270",
        "40273",
        "40278",
        "40306",
        "40307",
        "40800",
        "40145",
        "40398",
        "40035",
        "40115",
        "40703",
        "41475",
        "41476",
        "40827",
        "40828",
        "40829",
        "40830",
        "40831",
        "40832",
        "40833",
        "41320",
        "40834",
        "40846",
        "41321",
        "41322",
        "41323",
        "41324",
        "41000",
        "41426",
        "41427",
        "40467",
        "40664",
        "40665",
        "40258",
        "41234",
        "40034",
        "40984",
        "41539",
        "40985",
        "41540",
        "41541",
        "40117",
        "40577",
        "40015",
        "40010",
        "40240",
        "41542",
        "40241",
        "40528",
        "40683",
        "40986",
        "41543",
        "40684",
        "40752",
        "41423",
        "40656",
        "40657",
        "40954",
        "40160",
        "41571",
        "40530",
        "40635",
        "40797",
        "40878",
        "41235",
        "41236",
        "41249",
        "40722",
        "41497",
        "41498",
        "41500",
        "40958",
        "40959",
        "41512",
        "41526",
        "40304",
        "40292",
        "40873",
        "41376",
        "41708",
        "41377",
        "41440",
        "40005",
        "40761",
        "40885",
        "41707",
        "41244",
        "40668",
        "41544",
        "41545",
        "40835",
        "40023",
        "40011",
        "40584",
        "40272",
        "40287",
        "40176",
        "40177",
        "40449",
        "40414",
        "40469",
        "40888",
        "40289",
        "40470",
        "40501",
        "40711",
        "41417",
        "41418",
        "41419",
        "41420",
        "41017",
        "40704",
        "50521",
        "50522",
        "50189",
        "50190",
        "50325",
        "50248",
        "51383",
        "50317",
        "50318",
        "50319",
        "50320",
        "50321",
        "50322",
        "50323",
        "50324",
        "51281",
        "50326",
        "51760",
        "51070",
        "51878",
        "51935",
        "52045",
        "51855",
        "51883",
        "50800",
        "51122",
        "51136",
        "50826",
        "50978",
        "51146",
        "51208",
        "51212",
        "51264",
        "51267",
        "51707",
        "51808",
        "50544",
        "50603",
        "51768",
        "51018",
        "51056",
        "51077",
        "51101",
        "51090",
        "51104",
        "51159",
        "51161",
        "51170",
        "51176",
        "51228",
        "51242",
        "51789",
        "51852",
        "52206",
        "51918",
        "52027",
        "51948",
        "52100",
        "52215",
        "52216",
        "52217",
        "52218",
        "52219",
        "52220",
        "52221",
        "52222",
        "52223",
        "52224",
        "51678",
        "51954",
        "50773",
        "51120",
        "51164",
        "51254",
        "51804",
        "52064",
        "52138",
        "52225",
        "52227",
        "52228",
        "52229",
        "52230",
        "52232",
        "52233",
        "52234",
        "52235",
        "52237",
        "52238",
        "52239",
        "52240",
        "52241",
        "52242",
        "52243",
        "52244",
        "51066",
        "51141",
        "51233",
        "51286",
        "51764",
        "51778",
        "51851",
        "52148",
        "52245",
        "52247",
        "52248",
        "52249",
        "52250",
        "52252",
        "52254",
        "52255",
        "52256",
        "52257",
        "52258",
        "52259",
        "52260",
        "52261",
        "52262",
        "52263",
        "52264",
        "51765",
        "51916",
        "51950",
        "50472",
        "50473",
        "50891",
        "50769",
        "50807",
        "50828",
        "51091",
        "51160",
        "51177",
        "51182",
        "51782",
        "51790",
        "51824",
        "51865",
        "51901",
        "52265",
        "52266",
        "52267",
        "52268",
        "52269",
        "52270",
        "52271",
        "52272",
        "52273",
        "52274",
        "52275",
        "52276",
        "52277",
        "50948",
        "51195",
        "52285",
        "50053",
        "50052",
        "50051",
        "50050",
        "50127",
        "50118",
        "50063",
        "50062",
        "50117",
        "50116",
        "50804",
        "50046",
        "50045",
        "50044",
        "50043",
        "50035",
        "51731",
        "50802",
        "50439",
        "50054",
        "50554",
        "50559",
        "50609",
        "51881",
        "50616",
        "50621",
        "50435",
        "50619",
        "50122",
        "50433",
        "50474",
        "50729",
        "50797",
        "50048",
        "50047",
        "50049",
        "50119",
        "51074",
        "50061",
        "50505",
        "50060",
        "50507",
        "50059",
        "50058",
        "50632",
        "50057",
        "51237",
        "52147",
        "50120",
        "50471",
        "50968",
        "50967",
        "51180",
        "50926",
        "50436",
        "50622",
        "50770",
        "50623",
        "50644",
        "51893",
        "50056",
        "50055",
        "50121",
        "50645",
        "50969",
        "51876",
        "50796",
        "50272",
        "50924",
        "50925",
        "51773",
        "51786",
        "52177",
        "52323",
        "51009",
        "50937",
        "50790",
        "50312",
        "50191",
        "51800",
        "50830",
        "50423",
        "51520",
        "51042",
        "51045",
        "51046",
        "51051",
        "51052",
        "51054",
        "51059",
        "51108",
        "51118",
        "51130",
        "51154",
        "50346",
        "51259",
        "50347",
        "50481",
        "51072",
        "51171",
        "51282",
        "51730",
        "52021",
        "51100",
        "51192",
        "51521",
        "51952",
        "52193",
        "51067",
        "51157",
        "51708",
        "52097",
        "52157",
        "51099",
        "51223",
        "51226",
        "50516",
        "51257",
        "51677",
        "51783",
        "51805",
        "51884",
        "51919",
        "51953",
        "52036",
        "52146",
        "52156",
        "52160",
        "52194",
        "52196",
        "51162",
        "51943",
        "50313",
        "50483",
        "50092",
        "51813",
        "50941",
        "51779",
        "51793",
        "52071",
        "52114",
        "51041",
        "51043",
        "51047",
        "51048",
        "50314",
        "51093",
        "51724",
        "51945",
        "52066",
        "52158",
        "50178",
        "50898",
        "50082",
        "50652",
        "50655",
        "50658",
        "50660",
        "50661",
        "50663",
        "51008",
        "52282",
        "50665",
        "50114",
        "50666",
        "50667",
        "50668",
        "50669",
        "50670",
        "50671",
        "50672",
        "50673",
        "50674",
        "50675",
        "51295",
        "51296",
        "51613",
        "51614",
        "51738",
        "52283",
        "52284",
        "52168",
        "50638",
        "50763",
        "50821",
        "51770",
        "50827",
        "50618",
        "50894",
        "51185",
        "51207",
        "50809",
        "50884",
        "50549",
        "50608",
        "51068",
        "51086",
        "51116",
        "51132",
        "51143",
        "51234",
        "51256",
        "51753",
        "51761",
        "51788",
        "51794",
        "51809",
        "51928",
        "51972",
        "51988",
        "52119",
        "50815",
        "50829",
        "50887",
        "51214",
        "51097",
        "51178",
        "51198",
        "51283",
        "52076",
        "50041",
        "51896",
        "50947",
        "51114",
        "51145",
        "51217",
        "51245",
        "51265",
        "50550",
        "50393",
        "50596",
        "50512",
        "50610",
        "50647",
        "51085",
        "51144",
        "51225",
        "51680",
        "51766",
        "51791",
        "51792",
        "51825",
        "50091",
        "50113",
        "50987",
        "51057",
        "51075",
        "51123",
        "51229",
        "51785",
        "50683",
        "52286",
        "52328",
        "52333",
        "52351",
        "52367",
        "52329",
        "52334",
        "52352",
        "52335",
        "52345",
        "52353",
        "52359",
        "52336",
        "52346",
        "52354",
        "52360",
        "52324",
        "52342",
        "52330",
        "52356",
        "52337",
        "52338",
        "52343",
        "52361",
        "52325",
        "52339",
        "52347",
        "50541",
        "52331",
        "52348",
        "52357",
        "52362",
        "52349",
        "52350",
        "52326",
        "52332",
        "52340",
        "52344",
        "51389",
        "50230",
        "51196",
        "50950",
        "50555",
        "50556",
        "51870",
        "50642",
        "50641",
        "51704",
        "51712",
        "51745",
        "51826",
        "51859",
        "51887",
        "51923",
        "51925",
        "52308",
        "52309",
        "52310",
        "52311",
        "51578",
        "51566",
        "51903",
        "50478",
        "50866",
        "50895",
        "50703",
        "52281",
        "50345",
        "50863",
        "50867",
        "50868",
        "50897",
        "50222",
        "50692",
        "50994",
        "50385",
        "50716",
        "51690",
        "50818",
        "51280",
        "50819",
        "51744",
        "50820",
        "50852",
        "50811",
        "52214",
        "50777",
        "50778",
        "50779",
        "50780",
        "50781",
        "50782",
        "50783",
        "50812",
        "50971",
        "50997",
        "50999",
        "51002",
        "51247",
        "51821",
        "51857",
        "51858",
        "51877",
        "52017",
        "52167",
        "50910",
        "50966",
        "51702",
        "51703",
        "51739",
        "51822",
        "51860",
        "51908",
        "52313",
        "52327",
        "52341",
        "52355",
        "52358",
        "52125",
        "51006",
        "51615",
        "50396",
        "50397",
        "50398",
        "51284",
        "52289",
        "52290",
        "52291",
        "50911",
        "51958",
        "50183",
        "50184",
        "50803",
        "50545",
        "51270",
        "51013",
        "51202",
        "51211",
        "51853",
        "51941",
        "52035",
        "52186",
        "50723",
        "50237",
        "50458",
        "50883",
        "50912",
        "50945",
        "50089",
        "51181",
        "51879",
        "52192",
        "50185",
        "50186",
        "50187",
        "50188",
        "51007",
        "51227",
        "51907",
        "52185",
        "52195",
        "52202",
        "50377",
        "50378",
        "50816",
        "50817",
        "50899",
        "50938",
        "50942",
        "50977",
        "50991",
        "51019",
        "51023",
        "51044",
        "51055",
        "51071",
        "51078",
        "51131",
        "51135",
        "51088",
        "51147",
        "51166",
        "51183",
        "51187",
        "51205",
        "51215",
        "51224",
        "51239",
        "51266",
        "51812",
        "51894",
        "51934",
        "51951",
        "50379",
        "50380",
        "50381",
        "51915",
        "51959",
        "50382",
        "52023",
        "52034",
        "52101",
        "52113",
        "52115",
        "52150",
        "51000",
        "50088",
        "51061",
        "51115",
        "51142",
        "51175",
        "51206",
        "51231",
        "51243",
        "51244",
        "52044",
        "50087",
        "50437",
        "50030",
        "50639",
        "51012",
        "51151",
        "51153",
        "51210",
        "51222",
        "51276",
        "51278",
        "51287",
        "51288",
        "51803",
        "51906",
        "51927",
        "50181",
        "50901",
        "50943",
        "50976",
        "50086",
        "51017",
        "51022",
        "51053",
        "50085",
        "51063",
        "51079",
        "50084",
        "51089",
        "50083",
        "50032",
        "51082",
        "51092",
        "51094",
        "51087",
        "51102",
        "51107",
        "51110",
        "51193",
        "50438",
        "50115",
        "51152",
        "50129",
        "51163",
        "51167",
        "51186",
        "51209",
        "50767",
        "50135",
        "51219",
        "51238",
        "51246",
        "51249",
        "51260",
        "51273",
        "50813",
        "51807",
        "51811",
        "51850",
        "51900",
        "50238",
        "51914",
        "51924",
        "50315",
        "50316",
        "52022",
        "52065",
        "52135",
        "50383",
        "52169",
        "50449",
        "52301",
        "52302",
        "51409",
        "51775",
        "51869",
        "51871",
        "52190",
        "52060",
        "52061",
        "50399",
        "52314",
        "52315",
        "51407",
        "52369",
        "50952",
        "50957",
        "50958",
        "50959",
        "51369",
        "51699",
        "50953",
        "51370",
        "51371",
        "50724",
        "50906",
        "50907",
        "50963",
        "50964",
        "50965",
        "51367",
        "51368",
        "51373",
        "51374",
        "51563",
        "51828",
        "51829",
        "51456",
        "51457",
        "51458",
        "51459",
        "52287",
        "51460",
        "51461",
        "51462",
        "51463",
        "51464",
        "51465",
        "51466",
        "51467",
        "51468",
        "51469",
        "51471",
        "51472",
        "51473",
        "51474",
        "50432",
        "50682",
        "52288",
        "51683",
        "50166",
        "50205",
        "50151",
        "50197",
        "50198",
        "50199",
        "50153",
        "50192",
        "50175",
        "50177",
        "50329",
        "50176",
        "50162",
        "50163",
        "50144",
        "50145",
        "52307",
        "50172",
        "50154",
        "50461",
        "50873",
        "51366",
        "50491",
        "50686",
        "50260",
        "50539",
        "50031",
        "50998",
        "51235",
        "51081",
        "51158",
        "51125",
        "51126",
        "51127",
        "51128",
        "51735",
        "50993",
        "51746",
        "50951",
        "50876",
        "50954",
        "50955",
        "50956",
        "50167",
        "50168",
        "51411",
        "52303",
        "52366",
        "51413",
        "51733",
        "50880",
        "52306",
        "50725",
        "52139",
        "52143",
        "50789",
        "51213",
        "51252",
        "51989",
        "52043",
        "52141",
        "50271",
        "50701",
        "50801",
        "51240",
        "51892",
        "51096",
        "51124",
        "51112",
        "51174",
        "51258",
        "51291",
        "52184",
        "50709",
        "51121",
        "51197",
        "52142",
        "51003",
        "51184",
        "51867",
        "52046",
        "52108",
        "52174",
        "52201",
        "50824",
        "51084",
        "51150",
        "51201",
        "51220",
        "50615",
        "52099",
        "52140",
        "51113",
        "51139",
        "51156",
        "51199",
        "51866",
        "50604",
        "50791",
        "50992",
        "51060",
        "51129",
        "51109",
        "51134",
        "51137",
        "51168",
        "51248",
        "51250",
        "51763",
        "51823",
        "51880",
        "52170",
        "52204",
        "50042",
        "51926",
        "50771",
        "52102",
        "51039",
        "51040",
        "51277",
        "51279",
        "51025",
        "51026",
        "51027",
        "51028",
        "51029",
        "51030",
        "51031",
        "51032",
        "51033",
        "51034",
        "51035",
        "51036",
        "51037",
        "51038",
        "50853",
        "50854",
        "51657",
        "50161",
        "50201",
        "50202",
        "50203",
        "50149",
        "50150",
        "50909",
        "50375",
        "50387",
        "50388",
        "50389",
        "50193",
        "50236",
        "50160",
        "50194",
        "50152",
        "50206",
        "50207",
        "50208",
        "50195",
        "50196",
        "51694",
        "50147",
        "50148",
        "50164",
        "50165",
        "50156",
        "50157",
        "51289",
        "52200",
        "50090",
        "51564",
        "51565",
        "50519",
        "52178",
        "50634",
        "51898",
        "51973",
        "50612",
        "50636",
        "50822",
        "52007",
        "50702",
        "50776",
        "50805",
        "50229",
        "50235",
        "50613",
        "50402",
        "51268",
        "50806",
        "51064",
        "51105",
        "51095",
        "51111",
        "51148",
        "51149",
        "51191",
        "51200",
        "51216",
        "51232",
        "51251",
        "51769",
        "51780",
        "52026",
        "52118",
        "52149",
        "50727",
        "50768",
        "50808",
        "50810",
        "51292",
        "51931",
        "52162",
        "52175",
        "50944",
        "51065",
        "51098",
        "51119",
        "51218",
        "51236",
        "51241",
        "51255",
        "51781",
        "51799",
        "51944",
        "51961",
        "52024",
        "52069",
        "52077",
        "52120",
        "52122",
        "52153",
        "50731",
        "50794",
        "51806",
        "50633",
        "52032",
        "52121",
        "50646",
        "50134",
        "52181",
        "51020",
        "51117",
        "51138",
        "51221",
        "51253",
        "51762",
        "51784",
        "52038",
        "52072",
        "50715",
        "50131",
        "51069",
        "50132",
        "50775",
        "50823",
        "51165",
        "50340",
        "51103",
        "50133",
        "50401",
        "51073",
        "51133",
        "51140",
        "51172",
        "51173",
        "51179",
        "51194",
        "51261",
        "51263",
        "51271",
        "51767",
        "51801",
        "52094",
        "52124",
        "52179",
        "51749",
        "50490",
        "50602",
        "50704",
        "50708",
        "50714",
        "50735",
        "50860",
        "50861",
        "50862",
        "50988",
        "51188",
        "50979",
        "50980",
        "50981",
        "50982",
        "50983",
        "50984",
        "50985",
        "50986",
        "51155",
        "50832",
        "50833",
        "51818",
        "50834",
        "50835",
        "52292",
        "50927",
        "50453",
        "50454",
        "50455",
        "50498",
        "50928",
        "51522",
        "50262",
        "50278",
        "50279",
        "50485",
        "51819",
        "51523",
        "50263",
        "51524",
        "51525",
        "50404",
        "51526",
        "51621",
        "51622",
        "52298",
        "52299",
        "52300",
        "50836",
        "50837",
        "50838",
        "50839",
        "50264",
        "50280",
        "50405",
        "50486",
        "51820",
        "50261",
        "50270",
        "50281",
        "50282",
        "50283",
        "50284",
        "50285",
        "50286",
        "50287",
        "50334",
        "50406",
        "50407",
        "50431",
        "50487",
        "50488",
        "50489",
        "50877",
        "51623",
        "50288",
        "50289",
        "50408",
        "50494",
        "51624",
        "50290",
        "50291",
        "50292",
        "50293",
        "50294",
        "50295",
        "50333",
        "50332",
        "50409",
        "50410",
        "50411",
        "50412",
        "51633",
        "51625",
        "51626",
        "51627",
        "51628",
        "51629",
        "51630",
        "51631",
        "50296",
        "50297",
        "50413",
        "50499",
        "51636",
        "50298",
        "50299",
        "50348",
        "50429",
        "50430",
        "50500",
        "50527",
        "50136",
        "50300",
        "50414",
        "50496",
        "51637",
        "50137",
        "50256",
        "50257",
        "50258",
        "50548",
        "50259",
        "50331",
        "50330",
        "50376",
        "50400",
        "50415",
        "50428",
        "50515",
        "50497",
        "50495",
        "50528",
        "50720",
        "51638",
        "51639",
        "51640",
        "51641",
        "50301",
        "50302",
        "50349",
        "50013",
        "50529",
        "51647",
        "51527",
        "51528",
        "51529",
        "51530",
        "51531",
        "51532",
        "51533",
        "51534",
        "51535",
        "51536",
        "51537",
        "51538",
        "51539",
        "51540",
        "51541",
        "50026",
        "51718",
        "51658",
        "51659",
        "51660",
        "51661",
        "51662",
        "51663",
        "50303",
        "50304",
        "50350",
        "50226",
        "50530",
        "51648",
        "50305",
        "50306",
        "50307",
        "50338",
        "50337",
        "50351",
        "50352",
        "50353",
        "50354",
        "50355",
        "50356",
        "50441",
        "50442",
        "50443",
        "50444",
        "50227",
        "50531",
        "50532",
        "50533",
        "50534",
        "50719",
        "51649",
        "51650",
        "50308",
        "50357",
        "52293",
        "50535",
        "50358",
        "50359",
        "50360",
        "50361",
        "50362",
        "50363",
        "50364",
        "50365",
        "50456",
        "50457",
        "51913",
        "52294",
        "50536",
        "51651",
        "51719",
        "50309",
        "50310",
        "52295",
        "50537",
        "50311",
        "50538",
        "50676",
        "50677",
        "50678",
        "50679",
        "50680",
        "50681",
        "52296",
        "52297",
        "50718",
        "50717",
        "51734",
        "51542",
        "50460",
        "50275",
        "50648",
        "51543",
        "51544",
        "51545",
        "51546",
        "51652",
        "51653",
        "50728",
        "50840",
        "50649",
        "50209",
        "50881",
        "50888",
        "50277",
        "50864",
        "50210",
        "50034",
        "50651",
        "50384",
        "51547",
        "50492",
        "50394",
        "50650",
        "51548",
        "51549",
        "51550",
        "50841",
        "51579",
        "50422",
        "50427",
        "50842",
        "51551",
        "51797",
        "52086",
        "51728",
        "51848",
        "51189",
        "51274",
        "51190",
        "51798",
        "50025",
        "50023",
        "50022",
        "50021",
        "50020",
        "50419",
        "50420",
        "50421",
        "50416",
        "50417",
        "50503",
        "50418",
        "50024",
        "51713",
        "50386",
        "50635",
        "50067",
        "50465",
        "50886",
        "50066",
        "50721",
        "50065",
        "50617",
        "50064",
        "51691",
        "50221",
        "50019",
        "50018",
        "50239",
        "50017",
        "50240",
        "50016",
        "50241",
        "50015",
        "50242",
        "50014",
        "50243",
        "50689",
        "50900",
        "50366",
        "50367",
        "50368",
        "50369",
        "50370",
        "50371",
        "50372",
        "50373",
        "50374",
        "50341",
        "50342",
        "50343",
        "50344",
        "50484",
        "50502",
        "50694",
        "50517",
        "50598",
        "50599",
        "50606",
        "50607",
        "50710",
        "50711",
        "51605",
        "51616",
        "51996",
        "52089",
        "50111",
        "50138",
        "50139",
        "50110",
        "50557",
        "50577",
        "50109",
        "50140",
        "50141",
        "50108",
        "50142",
        "50143",
        "51750",
        "51751",
        "51752",
        "50107",
        "50561",
        "50579",
        "52105",
        "50336",
        "50736",
        "50737",
        "50105",
        "50563",
        "50581",
        "50104",
        "50738",
        "50582",
        "50103",
        "50921",
        "50102",
        "50564",
        "50583",
        "50224",
        "50565",
        "50739",
        "50101",
        "50566",
        "50584",
        "50100",
        "50567",
        "50585",
        "50099",
        "50553",
        "50586",
        "50098",
        "50570",
        "50587",
        "50097",
        "50571",
        "50588",
        "50096",
        "50572",
        "50589",
        "50094",
        "50574",
        "50591",
        "50225",
        "50575",
        "50734",
        "50093",
        "50576",
        "50592",
        "52106",
        "50752",
        "50504",
        "50753",
        "50266",
        "50569",
        "50593",
        "50740",
        "50741",
        "50742",
        "50746",
        "50747",
        "50748",
        "50749",
        "50182",
        "50916",
        "50917",
        "50918",
        "50501",
        "50245",
        "50246",
        "50247",
        "51560",
        "51561",
        "50040",
        "50038",
        "50037",
        "50128",
        "51562",
        "50039",
        "50540",
        "52372",
        "52316",
        "52317",
        "52318",
        "52319",
        "51203",
        "51204",
        "52320",
        "52370",
        "52321",
        "52322",
        "51269",
        "50078",
        "50130",
        "50448",
        "50905",
        "50077",
        "50076",
        "50075",
        "50033",
        "50036",
        "50074",
        "50831",
        "50069",
        "50073",
        "50072",
        "50070",
        "50071",
        "50068",
        "50931",
        "50785",
        "50932",
        "50792",
        "50795",
        "50933",
        "50513",
        "50939",
        "50934",
        "50935",
        "50940",
        "50630",
        "50629",
        "51015",
        "51021",
        "51875",
        "51889",
        "51888",
        "51909",
        "50395",
        "50560",
        "50620",
        "50231",
        "50081",
        "50509",
        "50625",
        "50787",
        "50514",
        "50627",
        "50631",
        "50628",
        "50080",
        "50793",
        "50936",
        "50268",
        "50269",
        "50339",
        "50391",
        "50392",
        "51890",
        "51929",
        "50029",
        "50434",
        "50467",
        "50470",
        "50975",
        "51016",
        "51681",
        "51717",
        "50690",
        "51004",
        "50990",
        "50786",
        "51619",
        "51620",
        "50946",
        "50929",
        "50112",
        "50843",
        "50079",
        "50211",
        "50212",
        "50213",
        "50214",
        "50844",
        "50845",
        "50216",
        "50217",
        "50445",
        "50273",
        "50446",
        "50846",
        "50847",
        "50848",
        "51385",
        "51386",
        "52208",
        "52209",
        "52210",
        "50849",
        "50390",
        "50123",
        "50124",
        "50125",
        "50447",
        "50219",
        "50274",
        "50466",
        "50126",
        "50713",
        "50712",
        "50850",
        "50851",
        "51005",
        "51387",
        "52211",
        "52212",
        "52213",
        "50480",
        "50605",
        "50523",
        "50726",
        "51580",
        "51732",
        "50524",
        "51272",
        "51275",
        "50885",
        "50890",
        "50949",
        "51771",
        "51817",
        "51736",
        "51737",
        "51740",
        "50871",
        "50859",
        "51849",
        "52002",
        "52029",
        "50774",
        "52364",
        "51553",
        "50825",
        "50973",
        "50506",
        "50764",
        "50765",
        "50908",
        "52126",
        "51058",
        "50233",
        "52312",
        "50624",
        "51910",
        "51827",
        "50158",
        "50159",
        "50169",
        "50170",
        "50327",
        "50328",
        "51010",
        "60909",
        "60967",
        "60033",
        "60032",
        "60681",
        "60459",
        "61023",
        "60099",
        "60110",
        "60109",
        "60104",
        "61055",
        "60103",
        "61251",
        "60223",
        "60224",
        "60228",
        "60226",
        "61094",
        "60917",
        "61223",
        "61003",
        "61362",
        "60399",
        "60880",
        "60465",
        "60473",
        "60611",
        "60003",
        "60991",
        "61246",
        "61247",
        "61248",
        "60114",
        "60877",
        "60196",
        "60878",
        "60879",
        "60559",
        "60560",
        "60609",
        "60610",
        "61249",
        "60873",
        "60874",
        "60875",
        "60876",
        "61233",
        "60372",
        "61293",
        "61029",
        "61024",
        "61202",
        "61208",
        "61283",
        "61092",
        "61284",
        "60393",
        "60540",
        "60394",
        "60172",
        "60173",
        "60482",
        "61258",
        "60419",
        "61259",
        "60541",
        "60395",
        "60331",
        "60332",
        "60410",
        "60411",
        "60542",
        "60396",
        "60585",
        "61303",
        "60126",
        "61093",
        "61158",
        "60910",
        "60577",
        "61056",
        "60994",
        "60468",
        "60021",
        "60614",
        "61173",
        "60632",
        "61006",
        "61064",
        "61139",
        "60672",
        "61207",
        "60016",
        "60019",
        "60017",
        "60112",
        "60371",
        "60035",
        "60366",
        "60341",
        "60045",
        "60044",
        "60601",
        "60377",
        "60022",
        "60670",
        "61131",
        "61025",
        "60887",
        "60207",
        "60904",
        "60225",
        "60546",
        "60376",
        "60805",
        "60347",
        "60547",
        "60235",
        "60328",
        "60375",
        "60489",
        "60409",
        "60461",
        "60464",
        "61296",
        "60981",
        "60976",
        "61308",
        "61309",
        "61310",
        "61075",
        "61076",
        "61080",
        "61119",
        "61306",
        "61102",
        "60418",
        "61089",
        "61059",
        "61109",
        "61148",
        "61149",
        "60913",
        "60914",
        "61257",
        "61188",
        "61228",
        "61229",
        "61230",
        "60555",
        "60795",
        "61231",
        "61099",
        "61101",
        "60700",
        "60934",
        "61300",
        "61301",
        "60665",
        "61297",
        "61298",
        "61299",
        "60037",
        "60603",
        "60928",
        "60036",
        "60492",
        "61240",
        "60741",
        "60239",
        "60210",
        "60457",
        "60374",
        "60742",
        "61241",
        "61242",
        "61243",
        "60318",
        "61232",
        "60809",
        "60810",
        "60811",
        "60812",
        "60467",
        "60043",
        "60015",
        "60220",
        "60643",
        "60380",
        "61255",
        "60936",
        "61194",
        "61078",
        "61060",
        "61067",
        "61088",
        "61163",
        "60709",
        "61164",
        "60535",
        "60697",
        "60536",
        "60593",
        "61086",
        "61182",
        "61081",
        "61082",
        "61083",
        "61084",
        "61085",
        "61095",
        "61096",
        "61097",
        "61118",
        "61107",
        "61215",
        "60240",
        "60617",
        "60327",
        "60579",
        "60463",
        "61252",
        "61253",
        "61313",
        "60186",
        "60551",
        "60187",
        "60391",
        "60958",
        "60390",
        "60188",
        "60189",
        "60245",
        "60349",
        "60387",
        "60386",
        "60452",
        "60212",
        "60213",
        "60221",
        "60340",
        "60350",
        "60385",
        "60384",
        "60190",
        "60222",
        "60237",
        "60389",
        "60383",
        "60597",
        "60483",
        "60388",
        "60462",
        "60214",
        "60215",
        "60600",
        "60484",
        "60522",
        "60218",
        "60216",
        "60217",
        "60219",
        "60194",
        "60584",
        "60244",
        "60458",
        "60373",
        "60578",
        "61057",
        "60031",
        "60030",
        "61307",
        "60400",
        "60836",
        "60835",
        "61311",
        "60562",
        "60241",
        "61312",
        "60613",
        "61234",
        "61235",
        "61236",
        "61237",
        "60619",
        "60591",
        "60227",
        "60571",
        "60678",
        "61260",
        "60580",
        "60915",
        "60138",
        "61295",
        "60106",
        "60931",
        "60330",
        "60921",
        "61329",
        "60397",
        "60728",
        "61199",
        "61161",
        "61209",
        "61205",
        "60817",
        "61211",
        "61115",
        "61008",
        "61009",
        "61238",
        "60421",
        "61198",
        "61339",
        "60558",
        "60243",
        "60100",
        "61256",
        "60107",
        "60026",
        "60025",
        "60144",
        "60471",
        "60024",
        "60023",
        "61304",
        "60561",
        "60588",
        "61305",
        "60403",
        "60115",
        "60042",
        "60171",
        "60041",
        "60013",
        "60151",
        "61363",
        "60369",
        "60174",
        "60334",
        "60911",
        "60195",
        "60912",
        "60637",
        "60636",
        "60001",
        "60818",
        "60924",
        "60118",
        "60184",
        "60002",
        "60119",
        "61289",
        "60398",
        "61150",
        "60335",
        "60955",
        "61167",
        "61184",
        "61187",
        "60639",
        "60708",
        "60722",
        "60732",
        "61138",
        "60807",
        "60549",
        "61239",
        "60826",
        "60622",
        "60333",
        "60014",
        "60012",
        "60486",
        "61285",
        "60136",
        "60137",
        "61128",
        "60808",
        "60980",
        "60988",
        "61290",
        "60029",
        "60028",
        "60192",
        "60197",
        "61120",
        "61200",
        "60641",
        "61157",
        "60163",
        "60370",
        "60455",
        "60209",
        "61227",
        "60605",
        "60563",
        "60564",
        "60888",
        "60889",
        "60890",
        "60565",
        "60930",
        "60108",
        "60101",
        "60113",
        "60891",
        "60166",
        "60319",
        "60320",
        "60322",
        "60323",
        "60324",
        "60167",
        "60168",
        "60169",
        "60586",
        "60896",
        "60897",
        "60566",
        "60567",
        "60568",
        "60898",
        "60899",
        "61090",
        "61091",
        "60018",
        "60175",
        "60007",
        "60006",
        "60595",
        "60005",
        "60004",
        "60608",
        "60616",
        "60040",
        "60039",
        "60008",
        "60392",
        "60626",
        "60135",
        "60581",
        "60170",
        "60569",
        "61302",
        "60105",
        "61174",
        "60494",
        "61140",
        "60661",
        "61168",
        "61169",
        "60211",
        "60606",
        "60543",
        "60544",
        "60545",
        "61245",
        "61172",
        "61143",
        "61058",
        "60038",
        "60121",
        "61286",
        "60165",
        "60231",
        "60552",
        "60191",
        "60997",
        "60598",
        "60998",
        "61287",
        "61011",
        "60537",
        "60797",
        "61104",
        "60664",
        "60694",
        "60695",
        "61098",
        "61100",
        "60711",
        "61132",
        "60987",
        "60602",
        "60798",
        "60799",
        "60238",
        "60414",
        "60412",
        "60413",
        "60644",
        "60645",
        "61224",
        "61225",
        "61226",
        "61250",
        "60592",
        "61291",
        "60422",
        "61292",
        "60027",
        "60011",
        "60420",
        "60885",
        "60851",
        "61254",
        "60193",
        "60849",
        "61294",
        "60315",
        "60236",
        "60381",
        "60382",
      ];
      // How to find the error node is throwing??
      console.log(crns.filter((x) => !old_crns.includes(x)));

      expect(actual).toBe(expected);
    }

    expect(await prisma.section.count()).toBe(NUM_SECTIONS);
  });

  test("Courses/sections are in GraphQL", async () => {
    for (const termId of Object.keys(NUMS_COURSES)) {
      const res = await query(gql`
        query {
          search(termId: "${termId}", query: "") {
            totalCount
          }
        }
      `);
      // It won't exactly match the number we have, but at least make sure we have SOMETHING
      expect(res.data?.search.totalCount).toBeGreaterThan(0);
    }
  });
});
